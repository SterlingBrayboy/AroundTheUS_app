!function(){"use strict";var e=class{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}},t=class extends e{constructor(e,t){super({popupSelector:e}),this._form=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputEls=[...this._form.querySelectorAll(".modal__input")]}setEventListeners(){this._popupElement.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}_getInputValues(){const e={};return this._inputEls.forEach((t=>{e[t.name]=t.value})),e}},r=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=document.querySelector(t),this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)]}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}toggleButtonState(){if(this._hasInvalidInput(this._inputEls))return this._submitButton.classList.add(this._inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}},o=class{constructor(e,t){let{items:r,renderer:o}=e;this._items=r,this._renderer=o,this._container=document.querySelector(`.${t}`)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}},s=class{constructor(e,t,r,o,s){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._handleImageClick=r,this._handleDeleteClick=o,this._handleLikeClick=s,this._cardSelector=t}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}isLiked(){return this._isLiked}handleLike=()=>{this._likeButton.classList.toggle("gallery__card-like_active")};handleDelete=()=>{this._element.remove()};updateLikeView(){this._isLiked?this._likeButton.classList.add("gallery__card-like_active"):this._likeButton.classList.remove("gallery__card-like_active")}_setEventListeners(){this._deleteFormButton.addEventListener("submit",this._handleDelete),this._cardTrash.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}generateCard(){return this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".gallery__card-like"),this._deleteFormButton=document.querySelector("#delete-card-button"),this._cardTrash=this._element.querySelector(".gallery__card-trash"),this._cardImageEl=this._element.querySelector(".gallery__card-image"),this._setEventListeners(),this._cardImageEl.src=this._link,this._cardImageEl.alt=`Photo of ${this._name}`,this._element.querySelector(".gallery__card-title").textContent=this._name,this.updateLikeView(),this._element}};const n={inputSelector:".modal__input",submitButtonSelector:".modal__container-button",inactiveButtonClass:"modal__container-button_disabled",inputErrorClass:"modal__input-error",errorClass:"modal__input-error_visible"},i={profileEditModal:"#profile__edit-modal",profileAddModal:"#profile__add-modal",profileEditForm:document.querySelector("#edit-card-form"),profileAddForm:document.querySelector("#add-card-form"),nameInput:document.querySelector("#profile-name-input"),profileTitle:document.querySelector("#profile-title"),descriptionInput:document.querySelector("#profile-description-input"),avatarInput:document.querySelector("#avatar-url-input"),avatarImage:document.querySelector(".profile__avatar"),avatarIconSelector:document.querySelector(".profile__icon"),avatarModal:"#avatar-modal",avatarModalButton:document.querySelector("#avatar-modal-button"),addCardClass:"#profile__add-modal",addModalButton:document.querySelector("#add-button"),editCardClass:"#profile__edit-modal",deleteCardClass:"#delete-modal",deleteCardButtonSelector:document.querySelector(".gallery__card-trash"),cardLikeButtonSelector:document.querySelector(".gallery__card-like"),editModalButton:document.querySelector("#edit-button"),profileEditButtonSelector:document.querySelector("#profile__edit-button"),profileAddButtonSelector:document.querySelector(".profile__add-button")},a=new class{constructor(e){this._headers=e.headers}getInitialCards(){return fetch("https://around-api.en.tripleten-services.com/v1/cards",{headers:{authorization:"ebfbe580-59e8-4623-9d1e-5edf14608279"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}loadInfo(){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{method:"GET",avatar:"https://practicum-content.s3.us-west-1.amazonaws.com/frontend-developer/moved_avatar.jpg",_id:"e20537ed11237f86bbb20ccb",cohort:"group-42",headers:{authorization:"ebfbe580-59e8-4623-9d1e-5edf14608279"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editProfile(e,t){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{method:"PATCH",headers:{authorization:"ebfbe580-59e8-4623-9d1e-5edf14608279","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e){return fetch("https://around-api.en.tripleten-services.com/v1/cards",{method:"POST",headers:{authorization:"ebfbe580-59e8-4623-9d1e-5edf14608279","Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`https://around-api.en.tripleten-services.com/v1/cards/${e}`,{method:"DELETE",headers:{authorization:"ebfbe580-59e8-4623-9d1e-5edf14608279","Content-Type":"application/json"},body:JSON.stringify({_id:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateLike(e,t){return fetch(`https://around-api.en.tripleten-services.com/v1/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:{authorization:"ebfbe580-59e8-4623-9d1e-5edf14608279","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateAvatar(e){return fetch("https://around-api.en.tripleten-services.com/v1/users/me/avatar",{method:"PATCH",headers:{authorization:"ebfbe580-59e8-4623-9d1e-5edf14608279","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"ebfbe580-59e8-4623-9d1e-5edf14608279","Content-Type":"application/json"}});let l;a.getInitialCards().then((e=>{l=new o({items:e,renderer:e=>{h(e)}},"gallery__cards"),l.renderItems(),console.log(e)})).catch(console.error),a.loadInfo().then((e=>{console.log(e),y.setUserInfo(e.name,e.about),y.setAvatar(e.avatar)})).catch(console.error);const d=new class extends e{constructor(e){super({popupSelector:e}),this._image=this._popupElement.querySelector(".modal__picture-src"),this._title=this._popupElement.querySelector(".modal__picture-title")}open(e){let{link:t,name:r}=e;this._image.src=t,this._image.alt=`A photo of ${r}`,this._title.textContent=`${r}`,super.open()}}("#picture-modal");function c(e,t){e.textContent=t}function u(e){d.open(e)}function h(e){const t=new s(e,"#card-template",u,p,m);l.addItem(t.generateCard())}d.setEventListeners();const _=new class extends e{constructor(e){super({popupSelector:e}),this._formEl=this._popupElement.querySelector(".modal__form")}setEventListeners(){this._formEl.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()})),super.setEventListeners()}setSubmitAction(e){this._handleFormSubmit=e}}(i.deleteCardClass);function p(e){_.open(),_.setSubmitAction((()=>{a.deleteCard(e._id).then((()=>{_.close(),e.handleDelete()})).catch(console.error)}))}function m(e){a.updateLike(e._id,e.isLiked()).then((()=>{e.handleLike(),console.log(e)})).catch(console.error)}_.setEventListeners();const v=new r(n,i.profileAddModal);v.enableValidation(),new r(n,i.profileEditModal).enableValidation(),new r(n,i.avatarModal).enableValidation();const f=new t(i.addCardClass,(function(e){c(i.addModalButton,"Saving..."),a.addNewCard(e).then((e=>{console.log(e),h(e),i.profileAddForm.reset(),v.toggleButtonState(),c(i.addModalButton,"Save")})),f.close()}));f.setEventListeners(),i.profileAddButtonSelector.addEventListener("click",(()=>{f.open()}));const E=new t(i.editCardClass,(function(e){c(i.editModalButton,"Saving..."),a.editProfile(e.name,e.description).then((e=>{y.setUserInfo(e.name,e.about),console.log(e)})).catch(console.error).finally((()=>{c(i.editModalButton,"Save")})),E.close()}));E.setEventListeners(),i.profileEditButtonSelector.addEventListener("click",(()=>{!function(){const e=y.getUserInfo();i.nameInput.value=e.name,i.descriptionInput.value=e.description,E.open()}()}));const S=new t(i.avatarModal,(function(e){c(i.avatarModalButton,"Saving..."),a.updateAvatar(e.link).then((t=>{i.avatarImage.src=e.link,console.log(t)})).catch(console.error).finally((()=>{c(i.avatarModalButton,"Save")})),S.close()}));S.setEventListeners(),i.avatarIconSelector.addEventListener("click",(()=>{S.open()}));const y=new class{constructor(e,t,r){this._userNameElement=document.querySelector(e),this._userDescriptionElement=document.querySelector(t),this._userAvatarSelector=document.querySelector(r)}getUserInfo(){return{name:this._userNameElement.textContent,description:this._userDescriptionElement.textContent}}setUserInfo(e,t){this._userNameElement.textContent=e,this._userDescriptionElement.textContent=t}setAvatar(e){this._userAvatarSelector.src=e}}(".profile__title",".profile__description",".profile__avatar")}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFjLElBQUlnRSxFQUN0QjNFLEVBQVVXLGFBYVosU0FBZ0MxRixHQUM5QmdKLEVBQWNqRSxFQUFVWSxrQkFBbUIsYUFDM0NVLEVBQ0cyQixhQUFhaEksRUFBWXNELE1BQ3pCc0QsTUFBTUMsSUFDTDlCLEVBQVVTLFlBQVlYLElBQU03RSxFQUFZc0QsS0FDeENnRixRQUFRQyxJQUFJMUIsRUFBSSxJQUVqQjJCLE1BQU1GLFFBQVFHLE9BQ2RxQixTQUFRLEtBQ1BkLEVBQWNqRSxFQUFVWSxrQkFBbUIsT0FBTyxJQUV0REQsRUFBWTFHLE9BQ2QsSUF2QkEwRyxFQUFZckcsb0JBTVowRixFQUFVVSxtQkFBbUIzRyxpQkFBaUIsU0FBUyxLQUhyRDRHLEVBQVkvRyxNQUlJLElBb0JsQixNQUFNK0osRUFBVyxJSXpOakIsTUFDRXRLLFdBQUFBLENBQVk4TCxFQUFrQkMsRUFBeUJDLEdBQ3JEN0wsS0FBSzhMLGlCQUFtQjVMLFNBQVNDLGNBQWN3TCxHQUMvQzNMLEtBQUsrTCx3QkFBMEI3TCxTQUFTQyxjQUN0Q3lMLEdBRUY1TCxLQUFLZ00sb0JBQXNCOUwsU0FBU0MsY0FBYzBMLEVBQ3BELENBRUFKLFdBQUFBLEdBQ0UsTUFBTyxDQUNMN0osS0FBTTVCLEtBQUs4TCxpQkFBaUIvSSxZQUM1QnVJLFlBQWF0TCxLQUFLK0wsd0JBQXdCaEosWUFFOUMsQ0FFQXFILFdBQUFBLENBQVl4SSxFQUFNMEosR0FDaEJ0TCxLQUFLOEwsaUJBQWlCL0ksWUFBY25CLEVBQ3BDNUIsS0FBSytMLHdCQUF3QmhKLFlBQWN1SSxDQUM3QyxDQUVBakIsU0FBQUEsQ0FBVXZCLEdBQ1I5SSxLQUFLZ00sb0JBQW9CMUYsSUFBTXdDLENBQ2pDLEdKbU1BLGtCQUNBLHdCQUNBLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXSXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0RWxzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIildO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXRFbC5uYW1lXSA9IGlucHV0RWwudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm1FbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybVNlbGVjdG9yKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxzLmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbHMpKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtjb250YWluZXJTZWxlY3Rvcn1gKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIGlzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQ7XG4gIH1cblxuICBoYW5kbGVMaWtlID0gKCkgPT4ge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImdhbGxlcnlfX2NhcmQtbGlrZV9hY3RpdmVcIik7XG4gIH07XG5cbiAgaGFuZGxlRGVsZXRlID0gKCkgPT4ge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gIH07XG5cbiAgdXBkYXRlTGlrZVZpZXcoKSB7XG4gICAgLy8gd3JpdGUgYSBwdWJsaWMgbWV0aG9kIHRvIHVwZGF0ZSBsaWtlIGljb24gYWZ0ZXIgc3VjY2Vzc2Z1bCByZXNwb25zZVxuICAgIC8vIGl0IGp1c3QgbmVlZHMgdG8gdG9nZ2xlIGEgY2xhc3MgcHJvYmFibHlcbiAgICAvLyB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJnYWxsZXJ5X19jYXJkLWxpa2VfYWN0aXZlXCIpO1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJnYWxsZXJ5X19jYXJkLWxpa2VfYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJnYWxsZXJ5X19jYXJkLWxpa2VfYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9kZWxldGVGb3JtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlRGVsZXRlKTtcbiAgICB0aGlzLl9jYXJkVHJhc2guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcbiAgICAgIC8vIHRoaXMuX2hhbmRsZUxpa2UoKVxuICAgIH0pO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICAvLyBzZWxlY3QgdGhlIGxpa2UgYnV0dG9uLCBzYXZlIHRvIHRoaXNcblxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZC1saWtlXCIpO1xuICAgIHRoaXMuX2RlbGV0ZUZvcm1CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jYXJkVHJhc2ggPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZC10cmFzaFwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkLWltYWdlXCIpO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkLXRpdGxlXCIpLnRleHRDb250ZW50ID1cbiAgICAgIHRoaXMuX25hbWU7XG5cbiAgICAvLyBpZiAodGhpcy5faXNMaWtlZCkge1xuICAgIC8vICAgdGhpcy51cGRhdGVMaWtlVmlldygpO1xuICAgIC8vIH1cblxuICAgIHRoaXMudXBkYXRlTGlrZVZpZXcoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhcmQ7XG4iLCJjb25zdCBjb25maWcgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2NvbnRhaW5lci1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fY29udGFpbmVyLWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yX3Zpc2libGVcIixcbn07XG5cbmNvbnN0IHZhcmlhYmxlcyA9IHtcbiAgcHJvZmlsZUVkaXRNb2RhbDogXCIjcHJvZmlsZV9fZWRpdC1tb2RhbFwiLFxuICBwcm9maWxlQWRkTW9kYWw6IFwiI3Byb2ZpbGVfX2FkZC1tb2RhbFwiLFxuICBwcm9maWxlRWRpdEZvcm06IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1jYXJkLWZvcm1cIiksXG4gIHByb2ZpbGVBZGRGb3JtOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWZvcm1cIiksXG4gIG5hbWVJbnB1dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIiksXG4gIHByb2ZpbGVUaXRsZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlXCIpLFxuICBkZXNjcmlwdGlvbklucHV0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIiksXG4gIGF2YXRhcklucHV0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci11cmwtaW5wdXRcIiksXG4gIGF2YXRhckltYWdlOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKSxcbiAgYXZhdGFySWNvblNlbGVjdG9yOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ljb25cIiksXG4gIGF2YXRhck1vZGFsOiBcIiNhdmF0YXItbW9kYWxcIixcbiAgYXZhdGFyTW9kYWxCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsLWJ1dHRvblwiKSxcbiAgYWRkQ2FyZENsYXNzOiBcIiNwcm9maWxlX19hZGQtbW9kYWxcIixcbiAgYWRkTW9kYWxCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWJ1dHRvblwiKSxcbiAgZWRpdENhcmRDbGFzczogXCIjcHJvZmlsZV9fZWRpdC1tb2RhbFwiLFxuICBkZWxldGVDYXJkQ2xhc3M6IFwiI2RlbGV0ZS1tb2RhbFwiLFxuICBkZWxldGVDYXJkQnV0dG9uU2VsZWN0b3I6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZC10cmFzaFwiKSxcbiAgY2FyZExpa2VCdXR0b25TZWxlY3RvcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkLWxpa2VcIiksXG4gIGVkaXRNb2RhbEJ1dHRvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWJ1dHRvblwiKSxcbiAgcHJvZmlsZUVkaXRCdXR0b25TZWxlY3RvcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX19lZGl0LWJ1dHRvblwiKSxcbiAgcHJvZmlsZUFkZEJ1dHRvblNlbGVjdG9yOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIiksXG59O1xuXG5leHBvcnQgeyBjb25maWcsIHZhcmlhYmxlcyB9O1xuIiwiaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXSXRoSW1hZ2UuanNcIjtcblxuaW1wb3J0IFBvcHVwV2l0aERlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanNcIjtcblxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcblxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5cbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbmltcG9ydCB7IGNvbmZpZywgdmFyaWFibGVzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG4vLyBBUElcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiZWJmYmU1ODAtNTllOC00NjIzLTlkMWUtNWVkZjE0NjA4Mjc5XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuLy8gU0VDVElPTlxuXG5sZXQgc2VjdGlvbjtcblxuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigocmVzKSA9PiB7XG4gICAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogcmVzLFxuICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgXCJnYWxsZXJ5X19jYXJkc1wiXG4gICAgKTtcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gICAgY29uc29sZS5sb2cocmVzKTtcbiAgfSlcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuXG5hcGlcbiAgLmxvYWRJbmZvKClcbiAgLnRoZW4oKHJlcykgPT4ge1xuICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgdXNlcmluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCk7XG4gICAgdXNlcmluZm8uc2V0QXZhdGFyKHJlcy5hdmF0YXIpO1xuICB9KVxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG5cbi8vIFBPUFVQIFdJVEggSU1BR0VcblxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjcGljdHVyZS1tb2RhbFwiKTtcblxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gU0FWRSBCVVRUT04gVEVYVCBDSEFOR0UgRlVOQ1RJT04gRk9SIEZPUk1TXG5cbmZ1bmN0aW9uIHNldEJ1dHRvblRleHQoYnV0dGluLCB0ZXh0KSB7XG4gIGJ1dHRpbi50ZXh0Q29udGVudCA9IHRleHQ7XG59XG5cbi8vIENBUkRcblxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhjYXJkRGF0YSkge1xuICBwb3B1cFdpdGhJbWFnZS5vcGVuKGNhcmREYXRhKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgY2FyZERhdGEsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICk7XG4gIHNlY3Rpb24uYWRkSXRlbShjYXJkLmdlbmVyYXRlQ2FyZCgpKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBzZXRCdXR0b25UZXh0KHZhcmlhYmxlcy5hZGRNb2RhbEJ1dHRvbiwgXCJTYXZpbmcuLi5cIik7XG4gIGFwaS5hZGROZXdDYXJkKGlucHV0VmFsdWVzKS50aGVuKChyZXMpID0+IHtcbiAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgIC8vIGNyZWF0ZSBhIG5ldyBjYXJkXG4gICAgY3JlYXRlQ2FyZChyZXMpO1xuICAgIC8vIHJlbmRlciBpdFxuICAgIHZhcmlhYmxlcy5wcm9maWxlQWRkRm9ybS5yZXNldCgpO1xuICAgIC8vIHRvZ2dsZSBidXR0b24gc3RhdGVcbiAgICBhZGRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgLy8gY2xvc2UgbW9kYWxcbiAgICBzZXRCdXR0b25UZXh0KHZhcmlhYmxlcy5hZGRNb2RhbEJ1dHRvbiwgXCJTYXZlXCIpO1xuICB9KTtcbiAgYWRkUG9wdXAuY2xvc2UoKTtcbn1cblxuLy8gSEFORExFIERFTEVURSBNT0RBTFxuXG5jb25zdCBkZWxldGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhEZWxldGUodmFyaWFibGVzLmRlbGV0ZUNhcmRDbGFzcyk7XG5kZWxldGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XG4gIC8vIG9wZW4gdGhlIG1vZGFsXG4gIGRlbGV0ZU1vZGFsLm9wZW4oKTtcbiAgLy8gc2V0IHRoZSBzdWJtaXQgYWN0aW9uXG4gIGRlbGV0ZU1vZGFsLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgZGVsZXRlTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgY2FyZC5oYW5kbGVEZWxldGUoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gIH0pO1xufVxuXG4vLyBDQVJEIExJS0VcblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcbiAgYXBpXG4gICAgLnVwZGF0ZUxpa2UoY2FyZC5faWQsIGNhcmQuaXNMaWtlZCgpKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGNhcmQuaGFuZGxlTGlrZSgpO1xuICAgICAgLy8gY2FyZC51cGRhdGVMaWtlVmlldygpO1xuICAgICAgY29uc29sZS5sb2coY2FyZCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gIC8vIGhhbmRsZSBjaGFuZ2luZyB0aGUgYnV0dG9uJ3Mgc3RhdGUgaW4gYSAudGhlbiBhZnRlciB0aGUgc3VjY2Vzc2Z1bCByZXNwb25zZVxufVxuXG4vLyBGT1JNIFZBTElEQVRPUlxuXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCB2YXJpYWJsZXMucHJvZmlsZUFkZE1vZGFsKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgdmFyaWFibGVzLnByb2ZpbGVFZGl0TW9kYWwpO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCB2YXJpYWJsZXMuYXZhdGFyTW9kYWwpO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIFBPUFVQIFdJVEggRk9STSAtIEFERCBGT1JNXG5cbmNvbnN0IGFkZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0odmFyaWFibGVzLmFkZENhcmRDbGFzcywgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XG5cbmZ1bmN0aW9uIG9wZW5BZGRGb3JtKCkge1xuICBhZGRQb3B1cC5vcGVuKCk7XG59XG5cbmFkZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbnZhcmlhYmxlcy5wcm9maWxlQWRkQnV0dG9uU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gIG9wZW5BZGRGb3JtKClcbik7XG5cbi8vIFBPUFVQIFdJVEggRk9STSAtIEVESVQgRk9STVxuXG5jb25zdCBlZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgdmFyaWFibGVzLmVkaXRDYXJkQ2xhc3MsXG4gIGhhbmRsZUVkaXRGb3JtU3VibWl0XG4pO1xuXG5mdW5jdGlvbiBvcGVuRWRpdEZvcm0oKSB7XG4gIGNvbnN0IHVzZXIgPSB1c2VyaW5mby5nZXRVc2VySW5mbygpO1xuICB2YXJpYWJsZXMubmFtZUlucHV0LnZhbHVlID0gdXNlci5uYW1lO1xuICB2YXJpYWJsZXMuZGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXIuZGVzY3JpcHRpb247XG4gIGVkaXRQb3B1cC5vcGVuKCk7XG59XG5cbmVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG52YXJpYWJsZXMucHJvZmlsZUVkaXRCdXR0b25TZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuRWRpdEZvcm0oKTtcbn0pO1xuXG4vLyBQT1BVUCBXSVRIIEZPUk0gLSBBVkFUQVIgRk9STVxuXG5jb25zdCBhdmF0YXJNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICB2YXJpYWJsZXMuYXZhdGFyTW9kYWwsXG4gIGhhbmRsZUF2YXRhckZvcm1TdWJtaXRcbik7XG5hdmF0YXJNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBvcGVuQXZhdGFyRm9ybSgpIHtcbiAgYXZhdGFyTW9kYWwub3BlbigpO1xufVxuXG52YXJpYWJsZXMuYXZhdGFySWNvblNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5BdmF0YXJGb3JtKCk7XG59KTtcblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBzZXRCdXR0b25UZXh0KHZhcmlhYmxlcy5hdmF0YXJNb2RhbEJ1dHRvbiwgXCJTYXZpbmcuLi5cIik7XG4gIGFwaVxuICAgIC51cGRhdGVBdmF0YXIoaW5wdXRWYWx1ZXMubGluaylcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB2YXJpYWJsZXMuYXZhdGFySW1hZ2Uuc3JjID0gaW5wdXRWYWx1ZXMubGluaztcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHZhcmlhYmxlcy5hdmF0YXJNb2RhbEJ1dHRvbiwgXCJTYXZlXCIpO1xuICAgIH0pO1xuICBhdmF0YXJNb2RhbC5jbG9zZSgpO1xufVxuXG4vLyBVU0VSIElORk9cblxuY29uc3QgdXNlcmluZm8gPSBuZXcgVXNlckluZm8oXG4gIFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gIFwiLnByb2ZpbGVfX2F2YXRhclwiXG4pO1xuXG5mdW5jdGlvbiBoYW5kbGVFZGl0Rm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBzZXRCdXR0b25UZXh0KHZhcmlhYmxlcy5lZGl0TW9kYWxCdXR0b24sIFwiU2F2aW5nLi4uXCIpO1xuICBhcGlcbiAgICAuZWRpdFByb2ZpbGUoaW5wdXRWYWx1ZXMubmFtZSwgaW5wdXRWYWx1ZXMuZGVzY3JpcHRpb24pXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlcmluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCk7XG4gICAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dCh2YXJpYWJsZXMuZWRpdE1vZGFsQnV0dG9uLCBcIlNhdmVcIik7XG4gICAgfSk7XG4gIGVkaXRQb3B1cC5jbG9zZSgpO1xufVxuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIC8vIGNvbnN0cnVjdG9yIGJvZHlcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzXCIsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJlYmZiZTU4MC01OWU4LTQ2MjMtOWQxZS01ZWRmMTQ2MDgyNzlcIixcbiAgICAgIH0sXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgLy8gaWYgdGhlIHNlcnZlciByZXR1cm5zIGFuIGVycm9yLCByZWplY3QgdGhlIHByb21pc2VcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXG5cbiAgbG9hZEluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWVcIiwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgYXZhdGFyOlxuICAgICAgICBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vZnJvbnRlbmQtZGV2ZWxvcGVyL21vdmVkX2F2YXRhci5qcGdcIixcbiAgICAgIF9pZDogXCJlMjA1MzdlZDExMjM3Zjg2YmJiMjBjY2JcIixcbiAgICAgIGNvaG9ydDogXCJncm91cC00MlwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBcImViZmJlNTgwLTU5ZTgtNDYyMy05ZDFlLTVlZGYxNDYwODI3OVwiLFxuICAgICAgfSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICAvLyBpZiB0aGUgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZWRpdFByb2ZpbGUobmFtZSwgYWJvdXQpIHtcbiAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS91c2Vycy9tZVwiLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJlYmZiZTU4MC01OWU4LTQ2MjMtOWQxZS01ZWRmMTQ2MDgyNzlcIixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICAvLyBpZiB0aGUgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gcGFzcyBuYW1lIGFuZCBsaW5rIGFzIGFyZ3VtZW50XG4gIGFkZE5ld0NhcmQoZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiZWJmYmU1ODAtNTllOC00NjIzLTlkMWUtNWVkZjE0NjA4Mjc5XCIsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICAvLyBpZiB0aGUgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goXG4gICAgICBgaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvY2FyZHMvJHtjYXJkSWR9YCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCJlYmZiZTU4MC01OWU4LTQ2MjMtOWQxZS01ZWRmMTQ2MDgyNzlcIixcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIF9pZDogY2FyZElkLFxuICAgICAgICB9KSxcbiAgICAgIH1cbiAgICApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVMaWtlKGNhcmRJZCwgaXNMaWtlZCkge1xuICAgIHJldHVybiBmZXRjaChcbiAgICAgIGBodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLFxuICAgICAge1xuICAgICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiZWJmYmU1ODAtNTllOC00NjIzLTlkMWUtNWVkZjE0NjA4Mjc5XCIsXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIH0sXG4gICAgICB9XG4gICAgKS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICAvLyBpZiB0aGUgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlQXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChcbiAgICAgIGBodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS91c2Vycy9tZS9hdmF0YXJgLFxuICAgICAge1xuICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiZWJmYmU1ODAtNTllOC00NjIzLTlkMWUtNWVkZjE0NjA4Mjc5XCIsXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBhdmF0YXI6IGF2YXRhcixcbiAgICAgICAgfSksXG4gICAgICB9XG4gICAgKS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICAvLyBpZiB0aGUgc2VydmVyIHJldHVybnMgYW4gZXJyb3IsIHJlamVjdCB0aGUgcHJvbWlzZVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19waWN0dXJlLXNyY1wiKTtcbiAgICB0aGlzLl90aXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19waWN0dXJlLXRpdGxlXCIpO1xuICB9XG5cbiAgb3Blbih7IGxpbmssIG5hbWUgfSkge1xuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gYEEgcGhvdG8gb2YgJHtuYW1lfWA7XG4gICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSBgJHtuYW1lfWA7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2Zvcm1FbCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxufVxuIiwiY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih1c2VyTmFtZVNlbGVjdG9yLCB1c2VyRGVzY3JpcHRpb25TZWxlY3RvciwgdXNlckF2YXRhclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fdXNlck5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl91c2VyRGVzY3JpcHRpb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHVzZXJEZXNjcmlwdGlvblNlbGVjdG9yXG4gICAgKTtcbiAgICB0aGlzLl91c2VyQXZhdGFyU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJBdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3VzZXJEZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uKSB7XG4gICAgdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl91c2VyRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XG4gIH1cblxuICBzZXRBdmF0YXIoYXZhdGFyKSB7XG4gICAgdGhpcy5fdXNlckF2YXRhclNlbGVjdG9yLnNyYyA9IGF2YXRhcjtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwidGhpcyIsIl9wb3B1cEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cCIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9mb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRFbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJmb3JFYWNoIiwiaW5wdXRFbCIsIm5hbWUiLCJ2YWx1ZSIsImNvbmZpZyIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWwiLCJfc3VibWl0QnV0dG9uIiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlRWwiLCJpZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJldmVyeSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJfbmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9jYXJkU2VsZWN0b3IiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJoYW5kbGVMaWtlIiwiX2xpa2VCdXR0b24iLCJ0b2dnbGUiLCJoYW5kbGVEZWxldGUiLCJfZWxlbWVudCIsInVwZGF0ZUxpa2VWaWV3IiwiX2RlbGV0ZUZvcm1CdXR0b24iLCJfaGFuZGxlRGVsZXRlIiwiX2NhcmRUcmFzaCIsIl9jYXJkSW1hZ2VFbCIsImdlbmVyYXRlQ2FyZCIsInNyYyIsImFsdCIsInZhcmlhYmxlcyIsInByb2ZpbGVFZGl0TW9kYWwiLCJwcm9maWxlQWRkTW9kYWwiLCJwcm9maWxlRWRpdEZvcm0iLCJwcm9maWxlQWRkRm9ybSIsIm5hbWVJbnB1dCIsInByb2ZpbGVUaXRsZSIsImRlc2NyaXB0aW9uSW5wdXQiLCJhdmF0YXJJbnB1dCIsImF2YXRhckltYWdlIiwiYXZhdGFySWNvblNlbGVjdG9yIiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJNb2RhbEJ1dHRvbiIsImFkZENhcmRDbGFzcyIsImFkZE1vZGFsQnV0dG9uIiwiZWRpdENhcmRDbGFzcyIsImRlbGV0ZUNhcmRDbGFzcyIsImRlbGV0ZUNhcmRCdXR0b25TZWxlY3RvciIsImNhcmRMaWtlQnV0dG9uU2VsZWN0b3IiLCJlZGl0TW9kYWxCdXR0b24iLCJwcm9maWxlRWRpdEJ1dHRvblNlbGVjdG9yIiwicHJvZmlsZUFkZEJ1dHRvblNlbGVjdG9yIiwiYXBpIiwib3B0aW9ucyIsIl9oZWFkZXJzIiwiaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiYXV0aG9yaXphdGlvbiIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwibG9hZEluZm8iLCJtZXRob2QiLCJhdmF0YXIiLCJjb2hvcnQiLCJlZGl0UHJvZmlsZSIsImFib3V0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGROZXdDYXJkIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsInVwZGF0ZUxpa2UiLCJ1cGRhdGVBdmF0YXIiLCJiYXNlVXJsIiwic2VjdGlvbiIsIlNlY3Rpb24iLCJjYXJkRGF0YSIsImNyZWF0ZUNhcmQiLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnJvciIsInVzZXJpbmZvIiwic2V0VXNlckluZm8iLCJzZXRBdmF0YXIiLCJwb3B1cFdpdGhJbWFnZSIsIl9pbWFnZSIsIl90aXRsZSIsInNldEJ1dHRvblRleHQiLCJidXR0aW4iLCJ0ZXh0IiwiY2FyZCIsIkNhcmQiLCJkZWxldGVNb2RhbCIsInNldFN1Ym1pdEFjdGlvbiIsImFkZEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiYWRkUG9wdXAiLCJQb3B1cFdpdGhGb3JtIiwicmVzZXQiLCJlZGl0UG9wdXAiLCJkZXNjcmlwdGlvbiIsImZpbmFsbHkiLCJ1c2VyIiwiZ2V0VXNlckluZm8iLCJvcGVuRWRpdEZvcm0iLCJ1c2VyTmFtZVNlbGVjdG9yIiwidXNlckRlc2NyaXB0aW9uU2VsZWN0b3IiLCJ1c2VyQXZhdGFyU2VsZWN0b3IiLCJfdXNlck5hbWVFbGVtZW50IiwiX3VzZXJEZXNjcmlwdGlvbkVsZW1lbnQiLCJfdXNlckF2YXRhclNlbGVjdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==